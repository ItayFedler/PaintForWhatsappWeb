var id=100;function toDataUrl(c,f){var a=new XMLHttpRequest;a.onload=function(){var b=new FileReader;b.onloadend=function(){f(b.result)};b.readAsDataURL(a.response)};a.open("GET",c);a.withCredentials=!0;a.responseType="blob";a.send()}
function getword(c,f){var a=chrome.extension.getURL("painter.html?id="+id++),b=null;chrome.tabs.onUpdated.addListener(function l(d,m){if(d==b&&"complete"==m.status){chrome.tabs.onUpdated.removeListener(l);for(var g=chrome.extension.getViews(),e=0;e<g.length;e++){var h=g[e];if(h.location.href==a){toDataUrl(c.srcUrl,function(k){h.setCanvasUrl(k);console.log(k)});break}}}});chrome.tabs.create({url:a},function(d){b=d.id})}
chrome.runtime.onInstalled.addListener(function(){chrome.contextMenus.create({title:"Edit and Share with Paint for Whatsapp\u2122 Web",contexts:["image"],onclick:getword})});